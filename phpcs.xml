<?xml version="1.0"?>
<ruleset name="WooCommerce Order Monitor">
    <description>PHP CodeSniffer configuration for WooCommerce Order Monitor plugin</description>

    <!-- Files to check -->
    <file>.</file>

    <!-- Exclude patterns -->
    <exclude-pattern>vendor/</exclude-pattern>
    <exclude-pattern>node_modules/</exclude-pattern>
    <exclude-pattern>*.min.js</exclude-pattern>
    <exclude-pattern>*.min.css</exclude-pattern>

    <!-- Use WordPress Coding Standards -->
    <rule ref="WordPress">
        <!-- Allow short array syntax -->
        <exclude name="Generic.Arrays.DisallowShortArraySyntax"/>
        
        <!-- Allow short PHP tags in templates -->
        <exclude name="Generic.PHP.DisallowShortOpenTag.EchoFound"/>
        
        <!-- Relax some naming conventions for compatibility -->
        <exclude name="WordPress.NamingConventions.ValidVariableName"/>
        <exclude name="WordPress.NamingConventions.ValidFunctionName"/>
        
        <!-- Allow direct database queries when properly prepared -->
        <exclude name="WordPress.DB.DirectDatabaseQuery"/>
        
        <!-- Allow file operations for plugin functionality -->
        <exclude name="WordPress.WP.AlternativeFunctions"/>
    </rule>

    <!-- WordPress-Extra rules -->
    <rule ref="WordPress-Extra">
        <!-- Exclude some overly strict rules -->
        <exclude name="WordPress.Files.FileName"/>
        <exclude name="WordPress.NamingConventions.ValidHookName"/>
    </rule>

    <!-- WordPress-Docs rules for documentation -->
    <rule ref="WordPress-Docs"/>

    <!-- Check for PHP cross-version compatibility -->
    <rule ref="PHPCompatibility"/>
    
    <!-- Set minimum PHP version -->
    <config name="minimum_supported_wp_version" value="5.0"/>
    <config name="testVersion" value="8.0-"/>

    <!-- Show progress -->
    <arg value="p"/>
    
    <!-- Show sniff codes in all reports -->
    <arg value="s"/>
    
    <!-- Use colors in output -->
    <arg name="colors"/>
    
    <!-- Show results with source codes -->
    <arg value="--report=full"/>
    
    <!-- Check up to 20 files simultaneously for faster processing -->
    <arg name="parallel" value="20"/>

    <!-- Custom rules for this plugin -->
    <rule ref="WordPress.Security.EscapeOutput"/>
    <rule ref="WordPress.Security.NonceVerification"/>
    <rule ref="WordPress.Security.ValidatedSanitizedInput"/>
    <rule ref="WordPress.DB.PreparedSQL"/>
    <rule ref="WordPress.DB.PreparedSQLPlaceholders"/>

    <!-- Text domain verification -->
    <rule ref="WordPress.WP.I18n">
        <properties>
            <property name="text_domain" type="array">
                <element value="woo-order-monitor"/>
            </property>
        </properties>
    </rule>

    <!-- Prefix verification -->
    <rule ref="WordPress.NamingConventions.PrefixAllGlobals">
        <properties>
            <property name="prefixes" type="array">
                <element value="woom"/>
                <element value="WOOM"/>
                <element value="WooCommerce_Order_Monitor"/>
            </property>
        </properties>
    </rule>
</ruleset>
